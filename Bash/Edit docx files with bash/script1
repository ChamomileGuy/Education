mkdir result;  # создание папки с готовыми документами, чтобы не захламлять основную папку
unzip грамота.docx -d tmp;  # разархивирование файла грамота.docx как zip архива, и помещение полученных файлов в директорию tmp 
fIO_OLD=ФИО  # временная переменная, чтобы заменять предыдущие изменённые ФИО в файле на новые
while read FIO;  # цикл для пробегания по всем ФИО из файла ФИО.txt
    # sed это утилита для замены текста в файлах
    # флаг -i уазывает, что нужно изменения нужно внести в файл, который читается
    # флаг "s" обозначает операцию замены, а прямые слэши выступают разделителями старой и новой строк
    # флаг "g" указывает, что каждое вхождение строки необходимо заменить
    # далее указывается файл, который нужно изменить
    do sed -i "s/$fIO_OLD/$FIO/g" tmp/word/document.xml;  
    cd tmp && zip -r ../result/"грамота $FIO.docx" * && cd ..;  # zip рекурсивно архивирует все файлы из tmp/ и помещает в result/
    fIO_OLD=$FIO;  # обновление временной переменной, чтобы изменять один и тот же файл, но с изменившимися ФИО
done < ФИО.txt; 
rm -rf tmp;  # удаление папки tmp
